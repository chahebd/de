Для анализа данных транзакционной активности клиентов в приложении банка требуется объединить информацию из разных источников и подготовить её для аналитики в виде конечной витрины. 
Данные находятся в s3 хранилище история изменения курсов валют лежит в currencies_history.csv, а история транзакций — в батчах transactions_batch_*.csv.

План выполнения:
С помощью дага в airflow подключаюсь к s3 хранилищу, загружаю курсы валют и данные по транзакциям на локальную машину, выгружаю содержимое csv файлов в staging слой vertica и выгружаю очищенные и обработанные данные в витрину.

1) Источником данных служит S3 хранилище. Работа выполняется одним дагом final_dag.py
2) В бакетах могут быть разные даты, поэтому я их загружаю инкрементально, обрабатывая с помощью pandas и сохраняю каждый файл бакета в отдельную папку с датой в названии
Пример директории: /data/2022-10-01/batch.csv Файл s3_2_csv.py
3) Следующая таска выгружает из соответствующей папки файл бакета в vertica слой stg. Файл csv_2_stg.py
4) В запросе выгрузки данных в cdm слой данные фильтруются: убираются аккаунты со значением -1, status = done. Файл stg_2_cdm.py

